

<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parking-SAE</title>
  <link rel="icon"  href="./vue/style/Logo.png" />
  <link rel="stylesheet" href="./api/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="./vue/style/style.css" />
</head>

<body>
  <div id="loaderContainer">
    <span id="loader"></span>
    <h4>Chargement en cours...</h4>
  </div>

  <div id="map"></div>

  <div id="routeInfo"></div>

  <button id="routeBtn">Aller au parking le plus proche</button>

  <script src="./api/leaflet/dist/leaflet.js"></script>

  <script type="module">
    import { MobileApp } from "./module/MobileApp.js";

    const app = new MobileApp();

    const routeBtn = document.getElementById("routeBtn");
    const routeInfo = document.getElementById("routeInfo");


    app.start();

    routeBtn.addEventListener("click", async () => {
      if (!app.userPos || !app.nearestParking) {
        alert("position en cours de récupération");
        return;
      }


      app.map.setNearestParkingMarker(app.nearestParking);


      app.startTracking();

      routeBtn.disabled = true;
      routeBtn.textContent = "Itinéraire affiché";


      const result = await app.showRoute(
        app.userPos,
        app.nearestParking.location
      );

      if (result) {
        routeInfo.textContent = `Distance : ${result.distanceKm} km | Durée : ${result.duration}`;
        routeInfo.style.display = "block";
      }

      
    });

  </script>
</body>

</html>
